<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saudi Arabia GDP Sector Evolution (2000-2030)</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
            text-align: center;
        }
        .chart-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .chart {
            width: 400px;
            height: 400px;
            margin: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        .chart:hover {
            transform: scale(1.05);
        }
        .chart-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-top: 10px;
            color: #2c3e50;
        }
        .slice {
            transition: transform 0.3s, filter 0.3s;
        }
        .slice:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
            cursor: pointer;
        }
        #info {
            position: absolute;
            background: rgba(255,255,255,0.95);
            border: 1px solid #ccc;
            padding: 15px;
            display: none;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 5px;
            font-size: 14px;
            max-width: 300px;
            z-index: 1000;
        }
        #details {
            margin-top: 30px;
            text-align: center;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .controls {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .control-btn {
            margin: 10px;
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.3s;
        }
        .control-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }
        .comparison-table th, .comparison-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .comparison-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .comparison-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .comparison-table tr:hover {
            background-color: #f5f5f5;
        }
        .timeline {
            position: relative;
            max-width: 1200px;
            margin: 40px auto;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: #3498db;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
        }
        .timeline-container {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
        }
        .timeline-container::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -17px;
            background-color: white;
            border: 4px solid #3498db;
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            right: 30px;
            border: medium solid #3498db;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent #3498db;
        }
        .right::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            left: 30px;
            border: medium solid #3498db;
            border-width: 10px 10px 10px 0;
            border-color: transparent #3498db transparent transparent;
        }
        .right::after {
            left: -16px;
        }
        .timeline-content {
            padding: 20px 30px;
            background-color: white;
            position: relative;
            border-radius: 6px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        #neom-info {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .sector-breakdown {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        .sector-card {
            width: 200px;
            padding: 15px;
            margin: 10px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        .sector-card:hover {
            transform: translateY(-5px);
        }
        .sector-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .sector-card p {
            font-size: 14px;
            color: #7f8c8d;
        }
        #line-chart {
            width: 100%;
            height: 400px;
            margin-top: 30px;
        }
        .tooltip {
            position: absolute;
            text-align: center;
            padding: 8px;
            font: 12px sans-serif;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Saudi Arabia GDP Sector Evolution (2000-2030)</h1>
        
        <div class="controls">
            <button id="animateBtn" class="control-btn">Animate Changes</button>
            <button id="resetBtn" class="control-btn">Reset View</button>
            <button id="exportPDF" class="control-btn">Export as PDF</button>
            <button id="toggleLegend" class="control-btn">Toggle Legend</button>
            <button id="showComparison" class="control-btn">Show Comparison Table</button>
            <button id="showTimeline" class="control-btn">Show Timeline</button>
            <button id="showLineChart" class="control-btn">Show Line Chart</button>
        </div>

        <div class="chart-container">
            <div class="chart" id="chart2000">
                <div class="chart-title">2000 GDP Split</div>
            </div>
            <div class="chart" id="chart2024">
                <div class="chart-title">2024 GDP Split</div>
            </div>
            <div class="chart" id="chart2030">
                <div class="chart-title">2030 GDP Split (Prediction)</div>
            </div>
        </div>

        <div id="info"></div>
        <div id="details"></div>

        <div id="comparisonTable" style="display: none;">
            <h2>Sector Comparison Table</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Sector</th>
                        <th>2000</th>
                        <th>2024</th>
                        <th>2030 (Predicted)</th>
                    </tr>
                </thead>
                <tbody id="comparisonTableBody">
                    <!-- Table content will be dynamically populated -->
                </tbody>
            </table>
        </div>

        <div id="timeline" class="timeline" style="display: none;">
            <h2>Saudi Arabia's Economic Timeline</h2>
            <!-- Timeline content will be dynamically populated -->
        </div>

        <div id="line-chart" style="display: none;">
            <h2>GDP Sector Growth Over Time</h2>
            <!-- Line chart will be rendered here -->
        </div>

        <div id="neom-info">
            <h2>NEOM and Vision 2030: Reshaping Saudi Arabia's Economy</h2>
            <p>NEOM, a cornerstone project of Saudi Arabia's Vision 2030, is set to revolutionize the Kingdom's economic landscape. This futuristic mega-city, spanning 26,500 square kilometers, aims to diversify Saudi Arabia's economy away from oil dependency.</p>
            <p>Key impacts of NEOM and Vision 2030 on Saudi Arabia's GDP split:</p>
            <ul>
                <li>Boosting the tourism sector through world-class attractions and accommodations</li>
                <li>Driving technology and innovation, creating new high-tech industries</li>
                <li>Enhancing renewable energy production, reducing reliance on fossil fuels</li>
                <li>Creating job opportunities in various sectors, reducing unemployment</li>
                <li>Attracting foreign investment, contributing to economic growth</li>
            </ul>
        </div>

        <div class="sector-breakdown">
            <div class="sector-card">
                <h3>Oil Sector</h3>
                <p>Transitioning from dominance to a balanced role in a diversified economy</p>
            </div>
            <div class="sector-card">
                <h3>Non-Oil Sector</h3>
                <p>Rapid growth driven by technology, manufacturing, and services</p>
            </div>
            <div class="sector-card">
                <h3>Tourism Sector</h3>
                <p>Emerging as a key contributor to GDP, supported by mega-projects like NEOM</p>
            </div>
            <div class="sector-card">
                <h3>Technology Sector</h3>
                <p>Driving innovation and creating new economic opportunities</p>
            </div>
            <div class="sector-card">
                <h3>Renewable Energy</h3>
                <p>Growing sector aimed at reducing reliance on fossil fuels</p>
            </div>
            <div class="sector-card">
                <h3>Healthcare</h3>
                <p>Expanding to meet the needs of a growing population</p>
            </div>
            <div class="sector-card">
                <h3>Education</h3>
                <p>Investing in human capital to support economic diversification</p>
            </div>
        </div>
    </div>

    <script>
        const data = {
            2000: [
                {sector: "Oil Sector", value: 87, color: "#FF6384", info: "In 2000, the oil sector dominated Saudi Arabia's GDP.", details: "Key industries: Crude Oil Extraction, Oil Refining"},
                {sector: "Non-Oil Sector", value: 6, color: "#36A2EB", info: "The non-oil sector was relatively small in 2000.", details: "Key industries: Basic Manufacturing, Agriculture"},
                {sector: "Public Sector", value: 7, color: "#FFCE56", info: "The public sector played a significant role in the economy.", details: "Key areas: Government Administration, Defense"}
            ],
            2024: [
                {sector: "Oil Sector", value: 50, color: "#FF6384", info: "The oil sector's share has decreased due to diversification efforts.", details: "Key industries: Petroleum, Natural Gas, Petrochemicals"},
                {sector: "Non-Oil Sector", value: 30, color: "#36A2EB", info: "The non-oil sector has grown significantly, reflecting economic diversification.", details: "Key industries: Manufacturing, Technology"},
                {sector: "Public Sector", value: 5, color: "#FFCE56", info: "The public sector's share has decreased slightly.", details: "Key areas: Government Services, Education, Healthcare"},
                {sector: "Tourism Sector", value: 10, color: "#4BC0C0", info: "Tourism has been growing, supported by Vision 2030 initiatives.", details: "Key attractions: NEOM, heritage sites, Red Sea resorts"},
                {sector: "Technology Sector", value: 5, color: "#9966FF", info: "Emerging technology sector driven by Vision 2030.", details: "Key areas: AI, Robotics, Smart Cities"},
                {sector: "Renewable Energy", value: 5, color: "#FF9F40", info: "Renewable energy initiatives are gaining traction.", details: "Key focus: Solar, Wind, and Hydrogen energy"},
                {sector: "Healthcare", value: 5, color: "#FFCE56", info: "Healthcare sector projected to expand further.", details: "Key focus: Medical Tourism, Telemedicine, Biotechnology"},
                {sector: "Education", value: 8, color: "#4BC0C0", info: "Education sector expected to play a crucial role in economic transformation.", details: "Key areas: STEM Education, Online Learning, Research & Development"}
            ],
            2030: [
                {sector: "Oil Sector", value: 35, color: "#FF6384", info: "Projected decrease in oil sector share due to Vision 2030 initiatives.", details: "Key focus: Sustainable Energy, Advanced Oil Technologies"},
                {sector: "Non-Oil Sector", value: 35, color: "#36A2EB", info: "Expected significant growth in non-oil sectors.", details: "Key industries: Advanced Manufacturing, Renewable Energy"},
                {sector: "Public Sector", value: 5, color: "#FFCE56", info: "Public sector expected to maintain a stable but efficient presence.", details: "Key areas: E-government, Smart Cities, Public-Private Partnerships"},
                {sector: "Tourism Sector", value: 15, color: "#4BC0C0", info: "Tourism projected to become a major contributor to GDP.", details: "Key projects: NEOM, Red Sea Project, Qiddiya"},
                {sector: "Technology Sector", value: 10, color: "#9966FF", info: "Technology sector expected to grow rapidly.", details: "Key areas: AI, Blockchain, IoT, Cybersecurity"},
                {sector: "Renewable Energy", value: 5, color: "#FF9F40", info: "Renewable energy initiatives are gaining traction.", details: "Key focus: Solar, Wind, and Hydrogen energy"},
                {sector: "Healthcare", value: 7, color: "#FFCE56", info: "Healthcare sector projected to expand further.", details: "Key focus: Medical Tourism, Telemedicine, Biotechnology"},
                {sector: "Education", value: 8, color: "#4BC0C0", info: "Education sector expected to play a crucial role in economic transformation.", details: "Key areas: STEM Education, Online Learning, Research & Development"}
            ]
        };

        const width = 400;
        const height = 400
                const radius = Math.min(width, height) / 2;

        const pie = d3.pie().value(d => d.value);
        const arc = d3.arc().innerRadius(0).outerRadius(radius);

        function createPieChart(year, containerId) {
            const svg = d3.select(`#${containerId}`)
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", `translate(${width / 2},${height / 2})`);

            const arcs = svg.selectAll("arc")
                .data(pie(data[year]))
                .enter()
                .append("g");

            arcs.append("path")
                .attr("d", arc)
                .attr("fill", d => d.data.color)
                .attr("class", "slice")
                .on("click", showDetails)
                .on("mousemove", moveInfo)
                .on("mouseenter", showInfo)
                .on("mouseleave", hideInfo);

            arcs.append("text")
                .attr("transform", d => `translate(${arc.centroid(d)})`)
                .attr("text-anchor", "middle")
                .text(d => `${d.data.sector} (${d.data.value}%)`)
                .style("font-size", "12px")
                .style("fill", "white");

            // Add legend
            const legend = svg.selectAll(".legend")
                .data(data[year])
                .enter()
                .append("g")
                .attr("class", "legend")
                .attr("transform", (d, i) => `translate(-${width / 2 + 20}, ${i * 20 - height / 2 + 20})`);

            legend.append("rect")
                .attr("width", 18)
                .attr("height", 18)
                .style("fill", d => d.color);

            legend.append("text")
                .attr("x", 24)
                .attr("y", 9)
                .attr("dy", ".35em")
                .text(d => d.sector);
        }

        const svg2000 = createPieChart(2000, "chart2000");
        const svg2024 = createPieChart(2024, "chart2024");
        const svg2030 = createPieChart(2030, "chart2030");

        function showInfo(event, d) {
            const info = d3.select("#info");
            info.style("display", "block")
                .html(`<h3>${d.data.sector}</h3><p>${d.data.info}</p>`);
            moveInfo(event);
        }

        function hideInfo() {
            d3.select("#info").style("display", "none");
        }

        function moveInfo(event) {
            const info = d3.select("#info");
            info.style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY + 10) + "px");
        }

        function showDetails(event, d) {
            const details = d3.select("#details");
            details.html(`
                <h2>${d.data.sector}</h2>
                <p>${d.data.info}</p>
                <p><strong>Additional Details:</strong> ${d.data.details}</p>
            `);
        }

        // Animation function
        function animateChanges() {
            const transitionDuration = 1000;

            // Animate 2000 to 2024
            svg2000.selectAll(".slice")
                .data(pie(data[2024]))
                .transition()
                .duration(transitionDuration)
                .attrTween("d", function(d) {
                    const interpolate = d3.interpolate(this._current, d);
                    this._current = interpolate(0);
                    return function(t) {
                        return arc(interpolate(t));
                    };
                });

            // Animate 2024 to 2030
            setTimeout(() => {
                svg2024.selectAll(".slice")
                    .data(pie(data[2030]))
                    .transition()
                    .duration(transitionDuration)
                    .attrTween("d", function(d) {
                        const interpolate = d3.interpolate(this._current, d);
                        this._current = interpolate(0);
                        return function(t) {
                            return arc(interpolate(t));
                        };
                    });
            }, transitionDuration);
        }

        // Reset function
        function resetCharts() {
            [svg2000, svg2024, svg2030].forEach((svg, index) => {
                const year = [2000, 2024, 2030][index];
                svg.selectAll(".slice")
                    .data(pie(data[year]))
                    .transition()
                    .duration(1000)
                    .attrTween("d", function(d) {
                        const interpolate = d3.interpolate(this._current, d);
                        this._current = interpolate(0);
                        return function(t) {
                            return arc(interpolate(t));
                        };
                    });
            });
        }

        // Export as PDF function
        function exportAsPDF() {
            const element = document.body;
            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jspdf.jsPDF();
                pdf.addImage(imgData, 'PNG', 0, 0);
                pdf.save("saudi_arabia_gdp_evolution.pdf");
            });
        }

        // Populate comparison table
        function populateComparisonTable() {
            const tbody = d3.select("#comparisonTableBody");
            tbody.html("");

            const allSectors = [...new Set([...data[2000], ...data[2024], ...data[2030]].map(d => d.sector))];

            allSectors.forEach(sector => {
                const row = tbody.append("tr");
                row.append("td").text(sector);
                [2000, 2024, 2030].forEach(year => {
                    const sectorData = data[year].find(d => d.sector === sector);
                    row.append("td").text(sectorData ? sectorData.value + "%" : "N/A");
                });
            });
        }

        // Call the function to populate the comparison table on load
        populateComparisonTable();

        // Timeline data
        const timelineData = [
            { year: 2000, description: "Oil sector dominates with 87% of GDP." },
            { year: 2016, description: "Vision 2030 announced, aiming for economic diversification." },
            { year: 2024, description: "Non-oil sector grows to 30%, tourism sector emerges." },
            { year: 2030, description: "NEOM project launched, aiming to transform the economy." }
        ];

        // Populate timeline
        function populateTimeline() {
            const timelineContainer = d3.select("#timeline");
            timelineData.forEach((event, index) => {
                const container = timelineContainer.append("div")
                    .attr("class", index % 2 === 0 ? "timeline-container left" : "timeline-container right");

                container.append("div")
                    .attr("class", "timeline-content")
                    .html(`<h3>${event.year}</h3><p>${event.description}</p>`);
            });
        }

        // Call the function to populate the timeline on load
        populateTimeline();

        // Line chart data preparation
        const lineChartData = [
            { year: 2000, oil: 87, nonOil: 6, public: 7, tourism: 0, technology: 0 },
            { year: 2024, oil: 50, nonOil: 30, public: 5, tourism: 10, technology: 5 },
            { year: 2030, oil: 35, nonOil: 35, public: 5, tourism: 15, technology: 10 }
        ];

        // Create line chart
        function createLineChart() {
            const margin = { top: 20, right: 30, bottom: 30, left: 40 };
            const lineWidth = 800 - margin.left - margin.right;
            const lineHeight = 400 - margin.top - margin.bottom;

            const svg = d3.select("#line-chart").append("svg")
                .attr("width", lineWidth + margin.left + margin.right)
                .attr("height", lineHeight + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear()
                .domain(d3.extent(lineChartData, d => d.year))
                .range([0, lineWidth]);

            const y = d3.scaleLinear()
                .domain([0, 100])
                .range([lineHeight, 0]);

            svg.append("g")
                .attr("transform", `translate(0,${lineHeight})`)
                .call(d3.axisBottom(x).ticks(5));

            svg.append("g")
                .call(d3.axisLeft(y).ticks(10));

            const line = d3.line()
                .x(d => x(d.year))
                .y(d => y(d.oil));

            svg.append("path")
                .datum(lineChartData)
                .attr("fill", "none")
                .attr("stroke", "#FF6384")
                .attr("stroke-width", 1.5)
                .attr("d", line);

            // Add other lines for non-oil, public, tourism, and technology
            const sectors = ["nonOil", "public", "tourism", "technology"];
            const colors = ["#36A2EB", "#FFCE56", "#4BC0C0", "#9966FF"];
            sectors.forEach((sector, index) => {
                const sectorLine = d3.line()
                    .x(d => x(d.year))
                    .y(d => y(d[sector]));

                svg.append("path")
                    .datum(lineChartData)
                    .attr("fill", "none")
                    .attr("stroke", colors[index])
                    .attr("stroke-width", 1.5)
                    .attr("d", sectorLine);
            });

            // Add legend
            const legend = svg.append("g")
                .attr("transform", `translate(${lineWidth - 100}, 20)`);

            sectors.forEach((sector, index) => {
                legend.append("rect")
                    .attr("x", 0)
                    .attr("y", index * 20)
                    .attr("width", 18)
                    .attr("height", 18)
                    .style("fill", colors[index]);

                legend.append("text")
                    .attr("x", 25)
                    .attr("y", index * 20 + 12)
                    .text(sector.charAt(0).toUpperCase() + sector.slice(1));
            });
        }

        // Show line chart on button click
        d3.select("#showLineChart").on("click", () => {
            const lineChart = d3.select("#line-chart");
            lineChart.style("display", lineChart.style("display") === "none" ? "block" : "none");
            if (lineChart.style("display") === "block") {
                createLineChart();
            }
        });

        // Finalize the setup
        console.log("Interactive GDP Visualization Initialized!");
    </script>
</body>
</html>
